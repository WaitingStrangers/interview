# 前端容器内部 Nginx 配置文件
# 用于处理单页应用的路由问题

server {
    # 监听 IPv4 的 80 端口
    listen       80;
    # 监听 IPv6 的 80 端口
    listen  [::]:80;
    # 服务器名称，这里设置为 localhost
    server_name  localhost;

    # 访问日志配置，当前已注释
    #access_log  /var/log/nginx/host.access.log  main;

    # 处理根路径的请求
    # 当用户访问 http://localhost/ 或其子路径时，使用以下配置
    location / {
        # 静态文件的根目录，指向 Nginx 默认的静态文件目录
        root   /usr/share/nginx/html;
        # 定义默认索引文件，当访问目录时，优先返回这些文件
        index  index.html index.htm;
        # 关键配置：处理单页应用路由
        # 工作原理：
        # 1. 当请求 /insert 时，首先尝试查找 /usr/share/nginx/html/insert 文件
        # 2. 如果找不到，尝试查找 /usr/share/nginx/html/insert 目录
        # 3. 如果都找不到，返回 /usr/share/nginx/html/index.html
        # 4. 浏览器加载 index.html 后，执行 Vue Router 的 JavaScript 代码
        # 5. Vue Router 根据 URL /insert 渲染对应的组件
        try_files $uri $uri/ /index.html;  # 这行是关键，处理单页应用路由
    }

    # 404 错误页面配置，当前已注释
    #error_page  404              /404.html;

    # 服务器错误页面配置
    # 当服务器返回 500、502、503、504 错误时，重定向到 /50x.html
    error_page   500 502 503 504  /50x.html;
    # 定义 /50x.html 的位置
    location = /50x.html {
        root   /usr/share/nginx/html;
    }

    # PHP 脚本代理配置，当前已注释
    # 我们的应用是纯前端，不需要处理 PHP 脚本
    #location ~ \.php$ {
    #    proxy_pass   http://127.0.0.1;
    #}

    # PHP FastCGI 配置，当前已注释
    # 我们的应用是纯前端，不需要处理 PHP 脚本
    #location ~ \.php$ {
    #    root           html;
    #    fastcgi_pass   127.0.0.1:9000;
    #    fastcgi_index  index.php;
    #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;
    #    include        fastcgi_params;
    #}

    # 禁止访问 .htaccess 文件，当前已注释
    # 我们的应用是纯前端，不需要处理 .htaccess 文件
    #location ~ /\.ht {
    #    deny  all;
    #}
}